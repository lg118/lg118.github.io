<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>
        木子李
    </title>
    <link rel="stylesheet" href="/libs/highlight/styles/monokai-sublime.css">
    <link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/css/style.css">
<link rel="alternate" href="/atom.xml" title="木子李" type="application/atom+xml">
</head>

<body id="bodyx">
    <div class="hd posts">
    <a href="/index.html"><i class="fa fa-reply replay-btn" aria-hidden="true"></i></a>
    <div class="post-title">
        <p>
            Shell学习-02
        </p>
        <hr>
    </div>
    <div class="post-content">
        <h2 id="for循环格式二"><a href="#for循环格式二" class="headerlink" title="for循环格式二"></a>for循环格式二</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">for...in 语句</span><br><span class="line">&#123;1..10&#125; #表示集合 1到10</span><br><span class="line">&#123;1,2,3&#125; #表示集合 1 2 3</span><br><span class="line">------------------------------</span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#循环输出1-10的所有数</span></span></span><br><span class="line">for i in &#123;1..10&#125;</span><br><span class="line">do</span><br><span class="line">  echo $i</span><br><span class="line">done</span><br><span class="line">--------------------------------</span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#循环输出1-10的所有数</span></span></span><br><span class="line">for i in &#123;1,2,3,4,5,6,7,8,9,10&#125;</span><br><span class="line">do</span><br><span class="line">  echo $i</span><br><span class="line">done</span><br><span class="line">------------------------------------</span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">for i in 1 2 3 4 5</span><br><span class="line">do</span><br><span class="line"> echo $i</span><br><span class="line">done</span><br><span class="line">-----------------------------------------</span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">a=(1 2 3 4 5)</span><br><span class="line">for i in $&#123;a[*]&#125;</span><br><span class="line">do</span><br><span class="line"> echo $i</span><br><span class="line">done</span><br><span class="line">--------------------------------------------</span><br><span class="line"></span><br><span class="line">"$*": #循环的时候，把所有的参数当作整体</span><br><span class="line">"$@": #循环的时候,把所有参数当成一个一个的元素</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">for i in "$*"</span><br><span class="line">do</span><br><span class="line">  echo $i</span><br><span class="line">done</span><br><span class="line">[root@hadoop10 opt]# ./forin03.sh 1 2 3 4 5</span><br><span class="line">1 2 3 4 5</span><br><span class="line">-------------------------------------------------</span><br><span class="line"><span class="meta">#</span><span class="bash">seq</span></span><br><span class="line">NAME</span><br><span class="line">       seq - print a sequence of numbers</span><br><span class="line">SYNOPSIS</span><br><span class="line">       seq [OPTION]... LAST</span><br><span class="line">       seq [OPTION]... FIRST LAST</span><br><span class="line">       seq [OPTION]... FIRST INCREMENT LAST</span><br><span class="line"></span><br><span class="line">----------------------</span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">for i in `seq 1 10`</span><br><span class="line">do</span><br><span class="line">  echo $i</span><br><span class="line">done</span><br><span class="line">----------------------</span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">for i in $(seq 1 10)</span><br><span class="line">do</span><br><span class="line">  echo $i</span><br><span class="line">done</span><br><span class="line">----------------------</span><br><span class="line">data.txt:</span><br><span class="line">1 2</span><br><span class="line">3 4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">for i in `cat /opt/data.txt`</span><br><span class="line">do</span><br><span class="line">   echo $i</span><br><span class="line">done</span><br><span class="line"><span class="meta">#</span><span class="bash">注意：<span class="keyword">for</span>循环能够识别空格、制表符和换行</span></span><br><span class="line">-------------------------------------</span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">read -p"请输入一个数字" START  END</span><br><span class="line">for i in $(seq $START $END)</span><br><span class="line">do</span><br><span class="line">  echo $i</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
<h2 id="while循环"><a href="#while循环" class="headerlink" title="while循环"></a>while循环</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">循环输出1-10的所有数 </span></span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">i=1</span><br><span class="line">while [ $i -le 10 ]</span><br><span class="line">do</span><br><span class="line">  echo $i</span><br><span class="line">  ((i++))</span><br><span class="line">done</span><br><span class="line">---------------------------------</span><br><span class="line"><span class="meta">#</span><span class="bash">循环输出1-10的所有偶数</span></span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">i=1</span><br><span class="line">while [ $i -le 10 ]</span><br><span class="line">do</span><br><span class="line">  if [ $[$i%2] -eq 0 ]</span><br><span class="line">  then</span><br><span class="line">    echo $i</span><br><span class="line">  fi</span><br><span class="line">    ((i++))</span><br><span class="line">done</span><br><span class="line">--------------------------------------</span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">while read i</span><br><span class="line">do</span><br><span class="line">  echo $i</span><br><span class="line">done &lt; /opt/data.txt</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># while 读取文本是按行读取</span></span></span><br><span class="line">----------------------------------------</span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">while :</span><br><span class="line">do</span><br><span class="line">  echo "shell---------"</span><br><span class="line">  sleep 2s</span><br><span class="line">done</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#这里的: 表示true</span></span></span><br></pre></td></tr></table></figure>
<h2 id="until循环"><a href="#until循环" class="headerlink" title="until循环"></a>until循环</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">until和while正好相反。</span><br><span class="line">while是条件成立时执行</span><br><span class="line">until是条件不成立时执行</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">read -p"输入一个数据：" i</span><br><span class="line">until [ $i -le 10 ]</span><br><span class="line">do</span><br><span class="line">  echo $i</span><br><span class="line">  ((i--))</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
<h2 id="循环中断"><a href="#循环中断" class="headerlink" title="循环中断"></a>循环中断</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="built_in">break</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">for i in `seq 1 10`</span><br><span class="line">do</span><br><span class="line">   if [ $i -eq 5 ]</span><br><span class="line">   then</span><br><span class="line">     break</span><br><span class="line">   fi</span><br><span class="line">    echo "$i"</span><br><span class="line">done</span><br><span class="line">-------------------------</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="built_in">continue</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">for i in `seq 1 10`</span><br><span class="line">do</span><br><span class="line">   if [ $i -eq 5 ]</span><br><span class="line">   then</span><br><span class="line">     continue</span><br><span class="line">   fi</span><br><span class="line">    echo "$i"</span><br><span class="line">done</span><br><span class="line">--------------------------</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="built_in">exit</span> 终止脚本程序</span></span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">for i in `seq 1 10`</span><br><span class="line">do</span><br><span class="line">   if [ $i -eq 5 ]</span><br><span class="line">   then</span><br><span class="line">     exit 100</span><br><span class="line">   fi</span><br><span class="line">    echo "$i"</span><br><span class="line">done</span><br><span class="line">echo "over----------"</span><br></pre></td></tr></table></figure>
<h2 id="编写脚本，检测当前网络中哪些服务器在线？？"><a href="#编写脚本，检测当前网络中哪些服务器在线？？" class="headerlink" title="编写脚本，检测当前网络中哪些服务器在线？？"></a>编写脚本，检测当前网络中哪些服务器在线？？</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#检测当前网络中哪些服务器在线？？</span></span></span><br><span class="line">for IP in `seq 1 254`</span><br><span class="line">do</span><br><span class="line">  ping -c1 -W1 192.168.10.$IP &amp;&gt;/dev/null</span><br><span class="line">  if [ $? -eq 0 ];then</span><br><span class="line">     echo "192.168.10.$IP is active" &gt;&gt; /opt/ip.txt </span><br><span class="line">  fi</span><br><span class="line">done &amp;</span><br></pre></td></tr></table></figure>
<h2 id="批量添加用户"><a href="#批量添加用户" class="headerlink" title="批量添加用户"></a>批量添加用户</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#批量添加用户</span></span></span><br><span class="line">for NAME in `cat /opt/names.txt`</span><br><span class="line">do</span><br><span class="line">    useradd $NAME</span><br><span class="line">    echo "123456" | passwd --stdin $NAME &amp;&gt; /dev/null</span><br><span class="line">done &amp;</span><br></pre></td></tr></table></figure>
<h2 id="编写一个脚本，实现将文件分发到其他远程节点"><a href="#编写一个脚本，实现将文件分发到其他远程节点" class="headerlink" title="编写一个脚本，实现将文件分发到其他远程节点"></a>编写一个脚本，实现将文件分发到其他远程节点</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#判断参数</span></span></span><br><span class="line">if [ $# -eq 0 ];then</span><br><span class="line">  echo "Please enter one or more files or directories!!"</span><br><span class="line">  exit 1</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#获取当前的用户名</span></span></span><br><span class="line">USERNAME=$(whoami)</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#获取当前的主机名</span></span></span><br><span class="line">HOSTNAME=$(hostname)</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#获取机配置文件nodes的路径</span></span></span><br><span class="line">DIRNAME=`dirname $0`</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#读取目标主机配置文件nodes</span></span></span><br><span class="line"></span><br><span class="line">for HOST in `cat $DIRNAME/nodes`</span><br><span class="line">do</span><br><span class="line">        if [ "$HOST" = "$HOSTNAME" ];then</span><br><span class="line">          continue</span><br><span class="line">        fi</span><br><span class="line">        </span><br><span class="line">        #获取文件</span><br><span class="line">        for file in $*</span><br><span class="line">         do</span><br><span class="line">         ## 获取文件的相对路径</span><br><span class="line">         DIR_NAME=`dirname $file`</span><br><span class="line">         ##获取文件的名称</span><br><span class="line">         FILE_NAME=$(basename $file)         </span><br><span class="line">         ## 相对路径转成绝对路径</span><br><span class="line">         FILE_ABS_PATH=`cd $DIR_NAME;pwd`</span><br><span class="line">         </span><br><span class="line">         rsync -rvl $FILE_ABS_PATH/$FILE_NAME $USERNAME@$HOST:$FILE_ABS_PATH</span><br><span class="line">        done</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
<h2 id="sed流编辑器-—-扩展"><a href="#sed流编辑器-—-扩展" class="headerlink" title="sed流编辑器 —- 扩展"></a>sed流编辑器 —- 扩展</h2><p>vim编辑器是基于交互方式的编辑器。在shell编程的代码我们需要通过代码编辑文本，此时使用sed流编辑器。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">sed语法格式</span></span><br><span class="line">sed [可选] command 文件</span><br><span class="line"><span class="meta">#</span><span class="bash">可选</span></span><br><span class="line">-n: #只会打印到匹配到的行</span><br><span class="line">-i: #修改原文件</span><br><span class="line">-r: #扩展正则</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="built_in">command</span></span></span><br><span class="line">这里可以是命令和正则规则</span><br><span class="line">d #删除</span><br><span class="line">n #</span><br><span class="line">p # 打印输出</span><br><span class="line"></span><br><span class="line">--------------------</span><br><span class="line">[root@hadoop10 opt]# sed -i '9,$d' 1.txt #删除第9行到最后一行，-i更改源文件</span><br><span class="line">[root@hadoop10 opt]# sed -n /daemon/p 1.txt #打印匹配的行</span><br><span class="line"></span><br><span class="line">[root@hadoop10 opt]# sed /adm/d 1.txt  #删除匹配内容的行</span><br><span class="line"></span><br><span class="line">[root@hadoop10 opt]# sed 's/bin/xxx/g' 1.txt &gt; 2.txt #将所有的bin替换成xxx,修改后的内容保存成2.txt</span><br></pre></td></tr></table></figure>
    </div>

    
        <hr class="fhr">
        <div id="vcomments"></div>
    
</div>
    <div class="footer" id="footer">
    <p>Copyright © 2020 <a class="flink" href="https://hexo.io" target="_blank" rel="noopener">Hexo</a>-<a class="flink" href="https://github.com/sanjinhub/hexo-theme-geek" target="_blank" rel="noopener">Geek</a>.
        <label class="el-switch el-switch-green el-switch-sm" style="vertical-align: sub;">
            <input type="checkbox" name="switch" id="update_style">
            <span class="el-switch-style"></span>
        </label>
<!--         <script type="text/javascript">
        var cnzz_protocol = (("https:" == document.location.protocol) ? "https://" : "http://");
        document.write(unescape("%3Cspan id='cnzz_stat_icon_1278548644'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "v1.cnzz.com/stat.php%3Fid%3D1278548644%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));
        </script> -->
    </p>
</div>
<input type="hidden" id="web_style" value="black">
<input type="hidden" id="valine_appid" value="CmCti21ooOOIzFOhEyFkFvR0-gzGzoHsz">
<input type="hidden" id="valine_appKey" value="FqiyUqbg7McKN2eG0MCewupf">
<script src="/libs/jquery.min.js"></script>
<script src="/libs/highlight/highlight.pack.js"></script>
<script src='//cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js'></script>
<script src="/js/js.js"></script>
<style type="text/css">
.v * {
    color: #698fca;
}

.v .vlist .vcard .vhead .vsys {
    color: #3a3e4a;
}

.v .vlist .vcard .vh .vmeta .vat {
    color: #638fd5;
}

.v .vlist .vcard .vhead .vnick {
    color: #6ba1ff;
}

.v a {
    color: #8696b1;
}

.v .vlist .vcard .vhead .vnick:hover {
    color: #669bfc;
}
</style>
</body>

</html>